- name: Create directory for database
  file:
    path: /opt/gitlab
    state: directory
    mode: '0755'

- name: Copy env file
  ansible.builtin.copy:
    src: ../../.env
    dest: /opt/gitlab/.env

- name: Copy docker compose file
  ansible.builtin.copy:
    src: docker-compose.yml
    dest: /opt/gitlab/docker-compose.yml

- name: Copy dockerfile
  ansible.builtin.copy:
    src: dockerfile
    dest: /opt/gitlab/dockerfile

- name: Build BDD image
  community.docker.docker_compose_v2:
    project_src: /opt/gitlab/
    state: present
    pull: "missing"
  register: output

- name: Show results
  ansible.builtin.debug:
    var: output.containers[0].Status
